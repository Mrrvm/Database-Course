////////////////////////////////// QUERIES

// Should it be nested?

SELECT DISTINCT name, value
FROM Patient, Wears, Reading, Sensor
WHERE Patient.p_number = Wears.patient
AND Wears.snum = Reading.snum
AND Wears.manuf = Reading.manuf
AND Reading.snum = Sensor.snum
AND Reading.manuf = Sensor.manuf
AND Sensor.units = "mg/dL"
AND Reading.value > 200
AND timestampdiff(day, current_timestamp , Reading.date_time) < 90;


// Past calendar year = 2016?? If its 2017 then there should be 2016 record to reassure the query
// Add patients who used all devices but not from Medtronic?
// Add patients with the same serial numbers but not from Medtronic? eg. 
	4 Medtronic and the fifth has the same serial number but is not Medtronic

SELECT name
FROM Patient, Request, Study, Device
WHERE Patient.p_number = Request.patient_id
AND Request.r_number = Study.request_number
AND Study.serial_number = Device.serialnum
AND Study.manufacturer = Device.manufacturer
AND datediff(Study.s_date, current_date) < 365
AND Study.manufacturer = "Medtronic"
GROUP BY Name
having count(Device.serialnum) >= ALL 
								(SELECT count(serialnum)
								FROM Device
								WHERE manufacturer = "Medtronic"
								);
		


